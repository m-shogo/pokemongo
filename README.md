# Pokémon GO IV OCR ツール

このリポジトリは、iPhone 上の Pokémon GO 画面を Windows PC にミラー表示し、9db の IV 計算ページ（https://9db.jp/pokemongo/data/6606）へ個体値情報を自動入力する Tampermonkey 用ユーザースクリプトとドキュメントをまとめたものです。

## 主な特徴
- **OCR 自動入力**: CP / HP / ほしのすなを Tesseract.js で認識し、9db のフォームへ転記します。
- **IV ゲージ推定**: こうげき / ぼうぎょ / HP バーの塗りつぶし率を読み取り、個体値スライダーへ反映します。
- **ポケモン名補完**: 名前枠を指定しておくと候補リストの先頭を自動選択できます。
- **ヘルプ内蔵**: 右下パネルの `?` ボタンで、導入から操作方法までの手順をいつでも確認できます。
- **ワンクリックコピー**: `?` → 「コードをコピー」を押すだけで最新スクリプト全文がクリップボードに入ります。

## 必要な環境
- Windows PC（ブラウザは最新の Google Chrome または Microsoft Edge を推奨）
- iPhone（Pokémon GO がプレイできる端末）
- 同一 Wi-Fi 上で AirPlay ミラーアプリを使用するか、キャプチャカードなどで映像を入力できる構成
- Tampermonkey ブラウザ拡張

> macOS でも類似の構成で利用可能です。詳しくは `docs/iv-ocr-tool.md` の「macOS 環境での事前準備」を参照してください。

## 導入手順
1. Chrome / Edge の拡張機能ストアから **Tampermonkey** を追加して有効化します。
2. 9db の IV 計算ページ（https://9db.jp/pokemongo/data/6606）を開きます。
3. 右下に表示される「IV OCR」パネルの `?` ボタン → 「コードをコピー」をクリックして、ユーザースクリプト全文をクリップボードへ取得します。
4. Tampermonkey のダッシュボードで「+ 新規スクリプト」を作成し、エディタの内容を全削除してからコピーしたコードを貼り付け、保存します。
5. 9db のページを再読み込みすると、右下に「IV OCR」パネルが表示され、利用可能な状態になります。

## 初回セットアップの流れ
1. **入力ソースを選択**: パネルで Screen（画面共有）または Camera（キャプチャカード）を選び、「開始」を押します。
2. **共有先を選ぶ**: ブラウザのダイアログでミラーアプリのウィンドウやキャプチャデバイスを選択し、共有を許可します。
3. **枠（ROI）を校正**: 「校正: CP」「校正: HP」「校正: すな」などボタンを押してから、プレビュー上で左上→右下と 2 回クリックして値が表示される領域を囲みます。
4. **保存**: 「保存」を押すと枠の位置が `localStorage` に保存され、次回以降自動で読み込まれます。
5. **自動入力を有効化**（任意）: 「自動入力」にチェックを入れると、安定した OCR 結果が 9db のフォームへ転記されます。
6. **追加校正**（必要に応じて）:
   - 「校正: 名前」または「自動: HPバー→名前」で名前枠を設定。
   - 「校正: こうげきバー / ぼうぎょバー / HPバー」または「自動: ラベル→バー」で IV ゲージ範囲を登録。

## 操作中のポイント
- 校正ボタンを押すとボーダーが色付きでハイライトされ、選択中の対象がひと目で分かります。
- 読み取った値はパネルの「最新値」「IV推定」に表示されます。値が安定しない場合は、枠の位置や画面の明るさを調整してください。
- 「候補を自動選択（先頭1件）」を ON にすると、ポケモン名の候補リストから先頭を自動クリックします。誤検出が気になる場合は OFF のままにしておきましょう。
- 「枠クリア」で全ての枠をリセットできます。再設定したいときに使用してください。

## トラブルシューティング
| 症状 | 対処法 |
| ---- | ------ |
| 共有するウィンドウが選択できない | ブラウザが古い可能性があります。最新版へ更新し、HTTPS ページ上で試してください。 |
| OCR の結果がブレる | 枠の位置を見直す、画面を明るくする、数値部分が大きく映るようにズームする。 |
| 自動入力されない | パネルの「自動入力」にチェックが入っているか確認し、枠が正しく保存されているかを確かめてください。 |
| ポップアップが開かない | ブラウザのポップアップブロックや拡張機能が動作を妨げていないか確認してください。 |

## ドキュメント
- 詳細な手順や背景知識は `docs/iv-ocr-tool.md` を参照してください。
- Tampermonkey 用スクリプト本体は `tampermonkey/iv-ocr.user.js` に収録されています。

## ライセンス
本リポジトリは個人用途を想定した学習プロジェクトです。ポリシーや利用条件についてはリポジトリのオーナーへお問い合わせください。
